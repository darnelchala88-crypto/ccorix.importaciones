{% extends 'base.html' %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h3>Productos</h3>
  <form class="d-flex" method="get"><input name="q" value="{{ q }}" class="form-control me-2" placeholder="Buscar..."><button class="btn btn-outline-primary">Buscar</button></form>
</div>
<div class="row">
  {% for p in products %}
  <div class="col-md-3">
    <div class="card">
      {% if p.image %}<img src="{{ url_for('uploaded_file', filename=p.image) }}" class="card-img-top" style="height:160px;object-fit:cover">{% endif %}
      <div class="card-body">
        <h5 class="card-title">{{ p.name }}</h5>
        <p class="card-text text-truncate">{{ p.description }}</p>
        <p class="mb-1"><strong>$ {{ '%.2f'|format(p.price) }}</strong></p>
        <form method="post" action="{{ url_for('cart_add', pid=p.id) }}">{{ csrf_token() }}<input type="hidden" name="qty" value="1"><button class="btn btn-sm btn-success">Agregar</button></form>
      </div>
    </div>
  </div>
  {% endfor %}
</div>
<nav class="mt-3"><ul class="pagination">
  {% for i in range(1, total_pages+1) %}
    <li class="page-item {{ 'active' if i==page }}"><a class="page-link" href="?q={{ q }}&page={{ i }}">{{ i }}</a></li>
  {% endfor %}
</ul></nav>
{% endblock %}